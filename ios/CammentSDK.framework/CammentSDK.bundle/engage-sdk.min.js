!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Engage",[],e):"object"==typeof exports?exports.Engage=e():t.Engage=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){if(c.enabled||console.log('Local storage is not supported by your browser. Please disable "Private Mode", or upgrade to a modern browser.'),t=t||{},l.requireOpts(t,["site","device"]),o(["desktop","mobile","tablet"],t.device)===-1)throw new Error("Invalid device: "+t.device);if(this.contentType=t.contentType||"Article",this.pulseOptions=t.pulseOptions||{},this.persistentCommonMetadata={site:t.site,device:t.device,endpoint:t.endpoint||"https://collector.schibsted.io/api/v1/track",userId:t.userId||null},this.pageEngage=new d(this.persistentCommonMetadata),this.articleEngage=new h(this.persistentCommonMetadata),i(this.contentType))this.engage=this.pageEngage,this.enableOverlay=!1,this.trackImpressions=t.trackImpressions;else{if("Article"!==this.contentType)throw new Error("Invalid content type: "+this.contentType+". Allowed values are: Page, Article(default).");this.engage=this.articleEngage,this.enableOverlay=t.enableOverlay&&"mobile"!==t.device,this.trackImpressions=!1}this.history=new f(t.referrer),this.setMetadata(this.history,t)}function i(t){return"Page"===t||"Frontpage"===t}var o=r(1),s=r(7),a=r(32),c=r(37),u=r(38),p=r(45).getUuidV4,l=r(54),h=r(55),d=r(80),f=r(82),g="7.16.0",m="//engage-cdn.schibsted.media/js/overlay/latest/overlay.min.js";n.Pulse=u,n.prototype.setMetadata=function(t,e){l.requireOpts(e,["permalink"]),"object"!=typeof e.previewUrl&&(e.previewUrl={}),e.previewUrl={http:e.previewUrl.http||null,https:e.previewUrl.https||null};var r={permalink:e.permalink,imageUrl:e.imageUrl||this.getImageUrl(),tags:e.tags||null};r.title=e.title||window.document.title,e.shareUrl=e.shareUrl||{},a("object"==typeof e.shareUrl,"ShareUrl must be an object"),r.shareUrl={facebook:e.shareUrl.facebook||e.permalink,twitter:e.shareUrl.twitter||e.permalink},e.experiments&&e.experiments.length?r.experiments=e.experiments:r.experiments=null,this.engage.setMetadata(t,r,e)},n.prototype.initialize=function(){this.pulse=new u(s(this.engage.setPulseMetadata({clientId:this.persistentCommonMetadata.site,url:this.persistentCommonMetadata.endpoint,userId:this.persistentCommonMetadata.userId,provider:{"spt:engage":this.persistentCommonMetadata.site}}),this.pulseOptions)),this.engage.view(this.pulse,this.history,g),c.enabled&&this.engage.createEngagementTime(this.pulse,this.history),this.enableOverlay&&this.loadOverlayTool(),this.trackImpressions&&this.engage.createImpressions(this.pulse)},n.prototype.destroy=function(){this.pageEngage.destroy(),this.articleEngage.destroy()},n.prototype.updateMetadata=function(t,e){t=t||{},"undefined"==typeof e&&(e=!0),l.requireOpts(t,["url"]),this.history.setUrl(t.url),this.history.setReferrer(t.referrer);var r=this.contentType;if(this.contentType=t.contentType||"Article","Article"===this.contentType)this.engage=this.articleEngage;else{if(!i(this.contentType))throw new Error("Invalid content type: "+this.contentType+". Allowed values are: Frontpage, Page, Article(default).");this.engage=this.pageEngage}this.setMetadata(this.history,t),this.pulse.pageViewId=p(),this.pulse=this.engage.setPulseMetadata(this.pulse),this.engage.view(this.pulse,this.history,g),"Article"===r&&"Article"===this.contentType?this.articleEngage.updateEngagementTime(this.pulse,this.history,e):"Article"===r&&i(this.contentType)?(this.articleEngage.destroy(),t.trackImpressions&&this.pageEngage.createImpressions(this.pulse)):i(r)&&"Article"===this.contentType?(this.pageEngage.destroy(),this.articleEngage.createEngagementTime(this.pulse,this.history)):i(r)&&i(this.contentType)&&(this.pageEngage.destroy(),t.trackImpressions&&this.pageEngage.createImpressions(this.pulse))},n.prototype.setReferringExperiment=function(t){t&&this.history.setReferringExperiment(t)},n.prototype.setReferringImpression=function(t){t&&this.history.setReferringImpression({entityId:t.hasAttribute("data-engage-entity-id")?t.getAttribute("data-engage-entity-id"):null,position:t.hasAttribute("data-engage-position")?parseInt(t.getAttribute("data-engage-position"),10):null,source:t.hasAttribute("data-engage-source")?t.getAttribute("data-engage-source"):null,transactionId:t.hasAttribute("data-engage-transaction-id")?t.getAttribute("data-engage-transaction-id"):null,pageViewId:this.pulse.pageViewId})},n.prototype.getImageUrl=function(){for(var t,e=document.getElementsByTagName("meta"),r=null,n=0;n<e.length;n++)if(t=e[n].getAttribute("property"),"og:image"===t){r=e[n].content;break}return r},n.prototype.loadOverlayTool=function(){var t=this.engage.articleId;window.loadOverlayToolCallback=function(e){if(e.jwt){var r=document.createElement("script");r.src=m,r.type="text/javascript",r.onload=function(){new window.EngageOverlay({site:e.newsroom,jwt:e.jwt,userId:e.userId,articleId:t})},document.body.appendChild(r)}};var e=document.createElement("script");e.src="https://engage-auth.schibsted.media/jwt/"+encodeURIComponent(this.engage.site)+"?callback=loadOverlayToolCallback",e.type="text/javascript",document.body.appendChild(e)},t.exports=n},function(t,e,r){function n(t,e,r){var n=t?t.length:0;if(!n)return-1;if("number"==typeof r)r=r<0?s(n+r,0):r||0;else if(r){var a=o(t,e),c=t[a];return(e===e?e===c:c!==c)?a:-1}return i(t,e,r)}var i=r(2),o=r(4),s=Math.max;t.exports=n},function(t,e,r){function n(t,e,r){if(e!==e)return i(t,r);for(var n=(r||0)-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}var i=r(3);t.exports=n},function(t,e){function r(t,e,r){for(var n=t.length,i=r?e||n:(e||0)-1;r?i--:++i<n;){var o=t[i];if(o!==o)return i}return-1}t.exports=r},function(t,e,r){function n(t,e,r){var n=0,s=t?t.length:n;if("number"==typeof e&&e===e&&s<=a){for(;n<s;){var c=n+s>>>1,u=t[c];(r?u<=e:u<e)?n=c+1:s=c}return s}return i(t,e,o,r)}var i=r(5),o=r(6),s=Math.pow(2,32)-1,a=s>>>1;t.exports=n},function(t,e){function r(t,e,r,o){e=r(e);for(var a=0,c=t?t.length:0,u=e!==e,p="undefined"==typeof e;a<c;){var l=n((a+c)/2),h=r(t[l]),d=h===h;if(u)var f=d||o;else f=p?d&&(o||"undefined"!=typeof h):o?h<=e:h<e;f?a=l+1:c=l}return i(c,s)}var n=Math.floor,i=Math.min,o=Math.pow(2,32)-1,s=o-1;t.exports=r},function(t,e){function r(t){return t}t.exports=r},function(t,e,r){t.exports=r(8)},function(t,e,r){var n=r(9),i=r(29),o=i(n);t.exports=o},function(t,e,r){function n(t,e,r){var n=o(e);if(!r)return i(e,t,n);for(var s=-1,a=n.length;++s<a;){var c=n[s],u=t[c],p=r(u,e[c],c,t,e);(p===p?p===u:u!==u)&&("undefined"!=typeof u||c in t)||(t[c]=p)}return t}var i=r(10),o=r(11);t.exports=n},function(t,e){function r(t,e,r){r||(r=e,e={});for(var n=-1,i=r.length;++n<i;){var o=r[n];e[o]=t[o]}return e}t.exports=r},function(t,e,r){var n=r(12),i=r(13),o=r(18),s=r(19),a=r(21),c=i(c=Object.keys)&&c,u=c?function(t){if(t)var e=t.constructor,r=t.length;return"function"==typeof e&&e.prototype===t||("function"==typeof t?a.enumPrototypes:r&&n(r))?s(t):o(t)?c(t):[]}:s;t.exports=u},function(t,e){function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}var n=Math.pow(2,53)-1;t.exports=r},function(t,e,r){function n(t){return null!=t&&(l.call(t)==a?h.test(p.call(t)):s(t)&&(o(t)?h:c).test(t)||!1)}var i=r(14),o=r(16),s=r(17),a="[object Function]",c=/^\[object .+?Constructor\]$/,u=Object.prototype,p=Function.prototype.toString,l=u.toString,h=RegExp("^"+i(l).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=n},function(t,e,r){function n(t){return t=i(t),t&&s.test(t)?t.replace(o,"\\$&"):t}var i=r(15),o=/[.*+?^${}()|[\]\/\\]/g,s=RegExp(o.source);t.exports=n},function(t,e){function r(t){return"string"==typeof t?t:null==t?"":t+""}t.exports=r},function(t,e){var r=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}();t.exports=r},function(t,e){function r(t){return t&&"object"==typeof t||!1}t.exports=r},function(t,e){function r(t){var e=typeof t;return"function"==e||t&&"object"==e||!1}t.exports=r},function(t,e,r){function n(t){for(var e=u(t),r=e.length,n=r&&t.length,l=n&&a(n)&&(o(t)||p.nonEnumStrings&&c(t)||p.nonEnumArgs&&i(t)),d=-1,f=[];++d<r;){var g=e[d];(l&&s(g,n)||h.call(t,g))&&f.push(g)}return f}var i=r(20),o=r(22),s=r(23),a=r(12),c=r(24),u=r(25),p=r(21),l=Object.prototype,h=l.hasOwnProperty;t.exports=n},function(t,e,r){function n(t){var e=o(t)?t.length:void 0;return i(e)&&p.call(t)==a||!1}var i=r(12),o=r(17),s=r(21),a="[object Arguments]",c=Object.prototype,u=c.hasOwnProperty,p=c.toString,l=c.propertyIsEnumerable;s.argsTag||(n=function(t){var e=o(t)?t.length:void 0;return i(e)&&u.call(t,"callee")&&!l.call(t,"callee")||!1}),t.exports=n},function(t,e,r){(function(e){var n=r(13),i="[object Arguments]",o="[object Object]",s=/\bthis\b/,a=Array.prototype,c=Error.prototype,u=Object.prototype,p=(p=e.window)&&p.document,l=u.toString,h=u.propertyIsEnumerable,d=a.splice,f={};!function(t){var r=function(){this.x=1},a={0:1,length:1},u=[];r.prototype={valueOf:1,y:1};for(var g in new r)u.push(g);f.argsTag=l.call(arguments)==i,f.enumErrorProps=h.call(c,"message")||h.call(c,"name"),f.enumPrototypes=h.call(r,"prototype"),f.funcDecomp=!n(e.WinRTError)&&s.test(function(){return this}),f.funcNames="string"==typeof Function.name,f.nodeTag=l.call(p)!=o,f.nonEnumStrings=!h.call("x",0),f.nonEnumShadows=!/valueOf/.test(u),f.ownLast="x"!=u[0],f.spliceObjects=(d.call(a,0,1),!a[0]),f.unindexedChars="x"[0]+Object("x")[0]!="xx";try{f.dom=11===p.createDocumentFragment().nodeType}catch(m){f.dom=!1}try{f.nonEnumArgs=!h.call(arguments,1)}catch(m){f.nonEnumArgs=!0}}(0,0),t.exports=f}).call(e,function(){return this}())},function(t,e,r){var n=r(12),i=r(13),o=r(17),s="[object Array]",a=Object.prototype,c=a.toString,u=i(u=Array.isArray)&&u,p=u||function(t){return o(t)&&n(t.length)&&c.call(t)==s||!1};t.exports=p},function(t,e){function r(t,e){return t=+t,e=null==e?n:e,t>-1&&t%1==0&&t<e}var n=Math.pow(2,53)-1;t.exports=r},function(t,e,r){function n(t){return"string"==typeof t||i(t)&&a.call(t)==o||!1}var i=r(17),o="[object String]",s=Object.prototype,a=s.toString;t.exports=n},function(t,e,r){function n(t){if(null==t)return[];p(t)||(t=Object(t));var e=t.length;e=e&&u(e)&&(s(t)||h.nonEnumStrings&&l(t)||h.nonEnumArgs&&o(t))&&e||0;for(var r=t.constructor,n=-1,i=a(r)&&r.prototype||j,d=i===t,f=Array(e),g=e>0,y=h.enumErrorProps&&(t===T||t instanceof Error),v=h.enumPrototypes&&a(t);++n<e;)f[n]=n+"";for(var b in t)v&&"prototype"==b||y&&("message"==b||"name"==b)||g&&c(b,e)||"constructor"==b&&(d||!S.call(t,b))||f.push(b);if(h.nonEnumShadows&&t!==j){var O=t===E?I:t===T?m:k.call(t),C=A[O]||A[w];for(O==w&&(i=j),e=x.length;e--;){b=x[e];var U=C[b];d&&U||(U?!S.call(t,b):t[b]===i[b])||f.push(b)}}return f}var i=r(26),o=r(20),s=r(22),a=r(27),c=r(23),u=r(12),p=r(18),l=r(24),h=r(21),d="[object Array]",f="[object Boolean]",g="[object Date]",m="[object Error]",y="[object Function]",v="[object Number]",w="[object Object]",b="[object RegExp]",I="[object String]",x=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],T=Error.prototype,j=Object.prototype,E=String.prototype,S=j.hasOwnProperty,k=j.toString,A={};A[d]=A[g]=A[v]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},A[f]=A[I]={constructor:!0,toString:!0,valueOf:!0},A[m]=A[y]=A[b]={constructor:!0,toString:!0},A[w]={constructor:!0},i(x,function(t){for(var e in A)if(S.call(A,e)){var r=A[e];r[t]=S.call(r,t)}}),t.exports=n},function(t,e){function r(t,e){for(var r=-1,n=t.length;++r<n&&e(t[r],r,t)!==!1;);return t}t.exports=r},function(t,e,r){(function(e){var n=r(28),i=r(13),o="[object Function]",s=Object.prototype,a=s.toString,c=i(c=e.Uint8Array)&&c,u=n(/x/)||c&&!n(c)?function(t){return a.call(t)==o}:n;t.exports=u}).call(e,function(){return this}())},function(t,e){function r(t){return"function"==typeof t||!1}t.exports=r},function(t,e,r){function n(t){return function(){var e=arguments.length,r=arguments[0];if(e<2||null==r)return r;if(e>3&&o(arguments[1],arguments[2],arguments[3])&&(e=2),e>3&&"function"==typeof arguments[e-2])var n=i(arguments[--e-1],arguments[e--],5);else e>2&&"function"==typeof arguments[e-1]&&(n=arguments[--e]);for(var s=0;++s<e;){var a=arguments[s];a&&t(r,a,n)}return r}}var i=r(30),o=r(31);t.exports=n},function(t,e,r){function n(t,e,r){if("function"!=typeof t)return i;if("undefined"==typeof e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)};case 5:return function(r,n,i,o,s){return t.call(e,r,n,i,o,s)}}return function(){return t.apply(e,arguments)}}var i=r(6);t.exports=n},function(t,e,r){function n(t,e,r){if(!s(r))return!1;var n=typeof e;if("number"==n)var a=r.length,c=o(a)&&i(e,a);else c="string"==n&&e in r;if(c){var u=r[e];return t===t?t===u:u!==u}return!1}var i=r(23),o=r(12),s=r(18);t.exports=n},function(t,e,r){(function(e){"use strict";/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
function n(t,e){if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}function o(t){return Object.prototype.toString.call(t)}function s(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}function a(t){if(b.isFunction(t)){if(T)return t.name;var e=t.toString(),r=e.match(E);return r&&r[1]}}function c(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function u(t){if(T||!b.isFunction(t))return b.inspect(t);var e=a(t),r=e?": "+e:"";return"[Function"+r+"]"}function p(t){return c(u(t.actual),128)+" "+t.operator+" "+c(u(t.expected),128)}function l(t,e,r,n,i){throw new j.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function h(t,e){t||l(t,!0,e,"==",j.ok)}function d(t,e,r,a){if(t===e)return!0;if(i(t)&&i(e))return 0===n(t,e);if(b.isDate(t)&&b.isDate(e))return t.getTime()===e.getTime();if(b.isRegExp(t)&&b.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(s(t)&&s(e)&&o(t)===o(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;a=a||{actual:[],expected:[]};var c=a.actual.indexOf(t);return c!==-1&&c===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),g(t,e,r,a))}return r?t===e:t==e}function f(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function g(t,e,r,n){if(null===t||void 0===t||null===e||void 0===e)return!1;if(b.isPrimitive(t)||b.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=f(t),o=f(e);if(i&&!o||!i&&o)return!1;if(i)return t=x.call(t),e=x.call(e),d(t,e,r);var s,a,c=S(t),u=S(e);if(c.length!==u.length)return!1;for(c.sort(),u.sort(),a=c.length-1;a>=0;a--)if(c[a]!==u[a])return!1;for(a=c.length-1;a>=0;a--)if(s=c[a],!d(t[s],e[s],r,n))return!1;return!0}function m(t,e,r){d(t,e,!0)&&l(t,e,r,"notDeepStrictEqual",m)}function y(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(r){}return!Error.isPrototypeOf(e)&&e.call({},t)===!0}function v(t){var e;try{t()}catch(r){e=r}return e}function w(t,e,r,n){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=v(e),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&l(i,r,"Missing expected exception"+n);var o="string"==typeof n,s=!t&&b.isError(i),a=!t&&i&&!r;if((s&&o&&y(i,r)||a)&&l(i,r,"Got unwanted exception"+n),t&&i&&r&&!y(i,r)||!t&&i)throw i}var b=r(33),I=Object.prototype.hasOwnProperty,x=Array.prototype.slice,T=function(){return"foo"===function(){}.name}(),j=t.exports=h,E=/\s*function\s+([^\(\s]*)\s*/;j.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=p(this),this.generatedMessage=!0);var e=t.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var n=r.stack,i=a(e),o=n.indexOf("\n"+i);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}},b.inherits(j.AssertionError,Error),j.fail=l,j.ok=h,j.equal=function(t,e,r){t!=e&&l(t,e,r,"==",j.equal)},j.notEqual=function(t,e,r){t==e&&l(t,e,r,"!=",j.notEqual)},j.deepEqual=function(t,e,r){d(t,e,!1)||l(t,e,r,"deepEqual",j.deepEqual)},j.deepStrictEqual=function(t,e,r){d(t,e,!0)||l(t,e,r,"deepStrictEqual",j.deepStrictEqual)},j.notDeepEqual=function(t,e,r){d(t,e,!1)&&l(t,e,r,"notDeepEqual",j.notDeepEqual)},j.notDeepStrictEqual=m,j.strictEqual=function(t,e,r){t!==e&&l(t,e,r,"===",j.strictEqual)},j.notStrictEqual=function(t,e,r){t===e&&l(t,e,r,"!==",j.notStrictEqual)},j["throws"]=function(t,e,r){w(!0,t,e,r)},j.doesNotThrow=function(t,e,r){w(!1,t,e,r)},j.ifError=function(t){if(t)throw t};var S=Object.keys||function(t){var e=[];for(var r in t)I.call(t,r)&&e.push(r);return e}}).call(e,function(){return this}())},function(t,e,r){(function(t,n){function i(t,r){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(r)?n.showHidden=r:r&&e._extend(n,r),I(n.showHidden)&&(n.showHidden=!1),I(n.depth)&&(n.depth=2),I(n.colors)&&(n.colors=!1),I(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),c(n,t,n.depth)}function o(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function c(t,r,n){if(t.customInspect&&r&&S(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return w(i)||(i=c(t,i,n)),i}var o=u(t,r);if(o)return o;var s=Object.keys(r),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(r)),E(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return p(r);if(0===s.length){if(S(r)){var m=r.name?": "+r.name:"";return t.stylize("[Function"+m+"]","special")}if(x(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(j(r))return t.stylize(Date.prototype.toString.call(r),"date");if(E(r))return p(r)}var y="",v=!1,b=["{","}"];if(f(r)&&(v=!0,b=["[","]"]),S(r)){var I=r.name?": "+r.name:"";y=" [Function"+I+"]"}if(x(r)&&(y=" "+RegExp.prototype.toString.call(r)),j(r)&&(y=" "+Date.prototype.toUTCString.call(r)),E(r)&&(y=" "+p(r)),0===s.length&&(!v||0==r.length))return b[0]+y+b[1];if(n<0)return x(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r);var T;return T=v?l(t,r,n,g,s):s.map(function(e){return h(t,r,n,g,e,v)}),t.seen.pop(),d(T,y,b)}function u(t,e){if(I(e))return t.stylize("undefined","undefined");if(w(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return v(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function p(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,r,n,i){for(var o=[],s=0,a=e.length;s<a;++s)U(e,String(s))?o.push(h(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,r,n,i,!0))}),o}function h(t,e,r,n,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),U(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=m(r)?c(t,u.value,null):c(t,u.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),I(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function d(t,e,r){var n=0,i=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function f(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function m(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function w(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function I(t){return void 0===t}function x(t){return T(t)&&"[object RegExp]"===A(t)}function T(t){return"object"==typeof t&&null!==t}function j(t){return T(t)&&"[object Date]"===A(t)}function E(t){return T(t)&&("[object Error]"===A(t)||t instanceof Error)}function S(t){return"function"==typeof t}function k(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function A(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}function C(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),M[t.getMonth()],e].join(" ")}function U(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var P=/%[sdj%]/g;e.format=function(t){if(!w(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(t).replace(P,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return t}}),a=n[r];r<o;a=n[++r])s+=m(a)||!T(a)?" "+a:" "+i(a);return s},e.deprecate=function(r,i){function o(){if(!s){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),s=!0}return r.apply(this,arguments)}if(I(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(n.noDeprecation===!0)return r;var s=!1;return o};var R,D={};e.debuglog=function(t){if(I(R)&&(R=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(R)){var r=n.pid;D[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else D[t]=function(){};return D[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=g,e.isNull=m,e.isNullOrUndefined=y,e.isNumber=v,e.isString=w,e.isSymbol=b,e.isUndefined=I,e.isRegExp=x,e.isObject=T,e.isDate=j,e.isError=E,e.isFunction=S,e.isPrimitive=k,e.isBuffer=r(35);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",C(),e.format.apply(e,arguments))},e.inherits=r(36),e._extend=function(t,e){if(!e||!T(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(e,function(){return this}(),r(34))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(p===setTimeout)return setTimeout(t,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){g&&d&&(g=!1,d.length?f=d.concat(f):m=-1,f.length&&a())}function a(){if(!g){var t=i(s);g=!0;for(var e=f.length;e;){for(d=f,f=[];++m<e;)d&&d[m].run();m=-1,e=f.length}d=null,g=!1,o(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var p,l,h=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(t){p=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(t){l=n}}();var d,f=[],g=!1,m=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];f.push(new c(t,e)),1!==f.length||g||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){var n,i,o;(function(r){"use strict";!function(r,s){i=[],n=s,o="function"==typeof n?n.apply(e,i):n,!(void 0!==o&&(t.exports=o))}(this,function(){function t(){try{return s in i&&i[s]}catch(t){return!1}}var e,n={},i="undefined"!=typeof window?window:r,o=i.document,s="localStorage",a="script";if(n.disabled=!1,n.version="1.3.20",n.set=function(t,e){},n.get=function(t,e){},n.has=function(t){return void 0!==n.get(t)},n.remove=function(t){},n.clear=function(){},n.transact=function(t,e,r){null==r&&(r=e,e=null),null==e&&(e={});var i=n.get(t,e);r(i),n.set(t,i)},n.getAll=function(){},n.forEach=function(){},n.serialize=function(t){return JSON.stringify(t)},n.deserialize=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t||void 0}},t())e=i[s],n.set=function(t,r){return void 0===r?n.remove(t):(e.setItem(t,n.serialize(r)),r)},n.get=function(t,r){var i=n.deserialize(e.getItem(t));return void 0===i?r:i},n.remove=function(t){e.removeItem(t)},n.clear=function(){e.clear()},n.getAll=function(){var t={};return n.forEach(function(e,r){t[e]=r}),t},n.forEach=function(t){for(var r=0;r<e.length;r++){var i=e.key(r);t(i,n.get(i))}};else if(o&&o.documentElement.addBehavior){var c,u;try{u=new ActiveXObject("htmlfile"),u.open(),u.write("<"+a+">document.w=window</"+a+'><iframe src="/favicon.ico"></iframe>'),u.close(),c=u.w.frames[0].document,e=c.createElement("div")}catch(p){e=o.createElement("div"),c=o.body}var l=function(t){return function(){var r=Array.prototype.slice.call(arguments,0);r.unshift(e),c.appendChild(e),e.addBehavior("#default#userData"),e.load(s);var i=t.apply(n,r);return c.removeChild(e),i}},h=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),d=function(t){return t.replace(/^d/,"___$&").replace(h,"___")};n.set=l(function(t,e,r){return e=d(e),void 0===r?n.remove(e):(t.setAttribute(e,n.serialize(r)),t.save(s),r)}),n.get=l(function(t,e,r){e=d(e);var i=n.deserialize(t.getAttribute(e));return void 0===i?r:i}),n.remove=l(function(t,e){e=d(e),t.removeAttribute(e),t.save(s)}),n.clear=l(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(s);for(var r=e.length-1;r>=0;r--)t.removeAttribute(e[r].name);t.save(s)}),n.getAll=function(t){var e={};return n.forEach(function(t,r){e[t]=r}),e},n.forEach=l(function(t,e){for(var r,i=t.XMLDocument.documentElement.attributes,o=0;r=i[o];++o)e(r.name,n.deserialize(t.getAttribute(r.name)))})}try{var f="__storejs__";n.set(f,f),n.get(f)!=f&&(n.disabled=!0),n.remove(f)}catch(p){n.disabled=!0}return n.enabled=!n.disabled,n})}).call(e,function(){return this}())},function(t,e,r){"use strict";function n(t){if(this.pulse2timing={init:a.dateNow()},t&&!t.optOut){if(this.optOut=!1,this.waitForOptOut=!1,t.waitForOptOut&&(this.optOut="wait",this.waitForOptOut=!0),!t.clientId)throw new Error("clientId is required");this.vars=o,this.version=f,this.clientId=("urn:schibsted.com:"+t.clientId).toLowerCase(),t.url?(this.url=t.url+"/"+this.clientId,this.pixelUrl=t.url):(this.url=this.vars.envVars.dataCollectorUrl+"/"+this.clientId,this.pixelUrl=this.vars.envVars.dataCollectorUrl),this.pageViewId=a.getUuidV4(),this.pixel=new u(this.pixelUrl,"pulse2",t.pixelThrottle),this.pixel.initPulsePixel(this.pageViewId,this.clientId),this.pulse2timing={pixelDone:a.dateNow()},t.transport?this.transport=t.transport:this.transport=new p,t.respectDoNotTrack===!0&&navigator&&1===navigator.doNotTrack?this.allowTracking=!1:this.allowTracking=!0,this.opts=t,this.contentId=t.contentId||t.pageId||encodeURIComponent(document.location),this.contentType=t.contentType||t.pageType||"Content",this.userIdDomain=t.userIdDomain,this.noRedirect=!0,this.utils=a,this.enrichmentFailed=!1,this.queue=new l(100),this.opts.localCookieNotSet=!1,this.events=new s(this),this.user=new c({userId:this.opts.userId,userIdDomain:this.opts.userIdDomain,userServiceUrl:this.opts.userServiceUrl,noRedirect:this.noRedirect,transport:this.transport,utils:this.utils,waitForOptOut:this.waitForOptOut}),this.plugins=new h(this.opts),this.trigger=new d(this),this.initIds(function(){}),this.plugins.call(this.plugins.sdkLoad,this)}}var i=r(39)("spt:pulse"),o={},s=r(42),a=r(45),c=r(46),u=r(50),p=r(47),l=r(51),h=r(52),d=r(53),f="2.5.8";try{o=r(48)}catch(g){o=r(49)}n.prototype.initIds=function(t){var e=this;t=t||function(){},i("Fetching Ids"),this.pulse2timing.fetchIds=a.dateNow(),this.user.getUserId(function(r,n){e.idsDoneCallback(r,n,t),e.plugins.call(e.plugins.sdkReady,e)})},n.prototype.idsDoneCallback=function(t,e,r){return t?(i("Failed to fetch ids from CIS",t),delete this.envId):(this.userId||(this.userId=e.userId),this.envId=e.envId),this.pulse2timing.receivedIds=a.dateNow(),this.waitingToTransmitQueue=!1,this.sendQueue(function(){}),this.user.syncIdsWithServer(function(){}),this.doPixelSync(),r(e)},n.prototype.doPixelSync=function(){var t,e="https://secure.adnxs.com/getuid?https://cis.schibsted.com/api/v1/sync?ANID=$UID";this.user.shouldSyncWithAn&&(this.user.shouldSyncWithAn=!1,this.user.setAnIdUnresolved(),t=new u(e,"pulse2an",1),t.initPixel())},n.prototype.sendQueue=function(t){var e,r,n=this;if(t=t||function(){},!this.queue.count())return t("no items in queue");if(!this.allowTracking)return t("tracking not allowed");if(this.plugins.call(this.plugins.eventCreated,this.queue.peekAll()),"send"!==this.isUserInfoResolved()||"send"!==this.optOutAction())return this.waitingToTransmitQueue=!0,t("not ready to send");for(i("Sending queue"),r=this.queue.pullAll(),e=0;e<r.length;e++)this.enrichEvents(r[e]);this.enrichmentFailed||(this.plugins.call(this.plugins.eventReady,r),this.transport.post(this.url,r,function(e){e?(i("Failed to send queue"),n.queue.pushMany(r),t(e)):(n.plugins.call(n.plugins.eventSent,r),t(null,!0))}))},n.prototype.send=function(t,e){var r=this;return e||(e=function(){}),this.allowTracking?(this.plugins.call(this.plugins.eventCreated,t),"send"!==this.isUserInfoResolved()||"send"!==this.optOutAction()?(this.queue.push(t),this.waitingToTransmitQueue=!0,e("not ready to send")):(i("Sending object"),this.enrichEvents(t),void(this.enrichmentFailed||(this.plugins.call(this.plugins.eventReady,t),this.transport.post(this.url,[t],function(n){n?(i("Failed to send object"),r.queue.push(t),e(n)):(r.plugins.call(r.plugins.eventSent,t),e(null,!0))}))))):e("tracking not allowed")},n.prototype.optOutAction=function(){return this.waitForOptOut&&"wait"===this.optOut?"wait":this.waitForOptOut&&this.optOut?"discard":"send"},n.prototype.setOptOut=function(t,e){return this.optOut=t,this.waitingToTransmitQueue===!0&&(this.waitingToTransmitQueue=!1),this.sendQueue(e)},n.prototype.isUserInfoResolved=function(){return"undefined"==typeof this.envId?"SDK: Waiting for envId":this.envId.indexOf("undefined")>-1?(delete this.envId,"SDK: Waiting for envId"):this.user.doTracking===!1?"CIS: user has opted out":"send"},n.prototype.enrichEvents=function(t){this.addTheIds(t),t.tracker.performance&&(t.tracker.performance.pulse2.sendEvents=a.dateNow()),this.user&&this.user.localCookieNotSet&&(t.tracker.localCookieNotSet=!0)},n.prototype.addTheIds=function(t){var e=this.user.getTheEnvironmentId(),r=this.user.getTheUserId(),n=this.user.getTheJweIds();if(t.actor&&e&&"undefined"!==e){if(0!==String(e).indexOf("urn:")){if(e.length>40)return void this.deleteEnvId();t.actor["@id"]="urn:schibsted.com:environment:"+e,t.actor["spt:environmentId"]="urn:schibsted.com:environment:"+e}else{if(e.length>70)return void this.deleteEnvId();t.actor["@id"]=e,t.actor["spt:environmentId"]=e}n&&(t.device.jweIds=n),t.actor["spt:userId"]=r}},n.prototype.deleteEnvId=function(){this.enrichmentFailed=!0,delete this.user.idObj.envId,this.refreshUserIds()},n.prototype.getPageViewId=function(){return this.pageViewId},n.prototype.setNewPageViewId=function(){this.pageViewId=a.getUuidV4()},n.prototype.getSessionId=function(){this.opts.debugMode&&console.log("activity.js: Deprecated: getSessionId")},n.prototype.userLogout=function(){delete this.user.idObj.userId,this.refreshUserIds()},n.prototype.userLogin=function(t){this.user.idObj.userId=t,this.refreshUserIds()},n.prototype.refreshUserIds=function(){this.waitingToTransmitQueue=!0,this.user.didSync=!1,this.initIds()},t.exports=n},function(t,e,r){(function(n){function i(){return!("undefined"==typeof window||!window||"undefined"==typeof window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document&&"WebkitAppearance"in document.documentElement.style||"undefined"!=typeof window&&window&&window.console&&(console.firebug||console.exception&&console.table)||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(t){var r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),r){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,n)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(r){}}function c(){try{return e.storage.debug}catch(t){}if("undefined"!=typeof n&&"env"in n)return n.env.DEBUG}function u(){try{return window.localStorage}catch(t){}}e=t.exports=r(40),e.log=s,e.formatArgs=o,e.save=a,e.load=c,e.useColors=i,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},e.enable(c())}).call(e,r(34))},function(t,e,r){function n(t){var r,n=0;for(r in t)n=(n<<5)-n+t.charCodeAt(r),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function i(t){function r(){if(r.enabled){var t=r,n=+new Date,i=n-(u||n);t.diff=i,t.prev=u,t.curr=n,u=n;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;a++;var i=e.formatters[n];if("function"==typeof i){var s=o[a];r=i.call(t,s),o.splice(a,1),a--}return r}),e.formatArgs.call(t,o);var c=r.log||e.log||console.log.bind(console);c.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=n(t),"function"==typeof e.init&&e.init(r),r}function o(t){e.save(t),e.names=[],e.skips=[];for(var r=(t||"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&(t=r[i].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=i.debug=i["default"]=i,e.coerce=c,e.disable=s,e.enable=o,e.enabled=a,e.humanize=r(41),e.names=[],e.skips=[],e.formatters={};var u},function(t,e){function r(t){if(t=String(t),!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*p;case"days":case"day":case"d":return r*u;case"hours":case"hour":case"hrs":case"hr":case"h":return r*c;case"minutes":case"minute":case"mins":case"min":case"m":return r*a;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function n(t){return t>=u?Math.round(t/u)+"d":t>=c?Math.round(t/c)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function i(t){return o(t,u,"day")||o(t,c,"hour")||o(t,a,"minute")||o(t,s,"second")||t+" ms"}function o(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,p=365.25*u;t.exports=function(t,e){e=e||{};var o=typeof t;if("string"===o&&t.length>0)return r(t);if("number"===o&&isNaN(t)===!1)return e["long"]?i(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){"use strict";function n(t){if(!t)throw new Error("activity required");this.activity=t,this.opts=t.opts,this.contentId=t.contentId,this.contentType=t.contentType}var i=r(43),o=r(44),s=r(45);n.prototype.trackContentView=function(t){var e=new o(this.activity);return e.type="View",e.object=this.addPageStandards(e.object),e.object.name=t||document.title,e.object.displayName=e.object.name,e.object.properties={},e.object.properties=this.reMapCustom(e.object.properties,"@type"),e.object.properties=this.reMapCustom(e.object.properties,"action"),e.object.properties=this.reMapCustom(e.object.properties,"item"),this.opts.filters&&(e.object.filters=this.opts.filters),document.referrer&&(e.origin={url:document.referrer}),this.opts.targetId&&this.opts.targetType&&(e.target={},e.target=this.addPageStandards(e.target,this.opts.targetId,this.opts.targetType)),this.opts.contentType&&("classifiedad"===this.opts.contentType.toLowerCase()&&(e.schema.schema="http://schema.schibsted.com/events/ad-view-event.json/27.json#"),"listing"===this.opts.contentType.toLowerCase()&&(e.schema.schema="http://schema.schibsted.com/events/search-result-list-view.json/31.json#")),new i(e,["object","origin"])},n.prototype.trackBasic=function(t,e,r,n){var s=new o(this.activity);return e=e||"Content",r=r||"undefined",s.id=this.getUrnIdWithContentType(r,e),s.type=t||"View","object"==typeof n?s.addCustomDataToProperty(s.object,n):s.activity.opts.debugMode&&console.log("events.js:trackBasic: objectMeta must be an object"),s.object["@id"]=this.getUrnIdWithContentType(r,e),s.object["@type"]=e,s.origin=this.addPageStandards(s.origin),new i(s,["object","origin"])},n.prototype.trackCreate=function(t,e,r){return this.trackBasic("Create",t,e,r)},n.prototype.trackUpdate=function(t,e,r){return this.trackBasic("Update",t,e,r)},n.prototype.trackReply=function(t,e,r){var n=new o(this.activity);return t=t||"Content",e=e||this.opts.contentId,n.id=this.getUrnIdWithContentType(e,t),n.type="Send",n.addCustomDataToProperty(n.object,r),n.object["@type"]=t,n.origin=this.addPageStandards(n.origin),new i(n,["object","origin"])},n.prototype.trackLogin=function(t,e,r){return this.trackBasic("Login",t,e,r)},n.prototype.trackLogout=function(t,e,r){return this.trackBasic("Logout",t,e,r)},n.prototype.trackClick=function(t,e,r,n,s){var a=new o(this.activity);return a.type=s||"Accept",a.object["@id"]=this.getUrnIdWithContentType(n,r)+":element:"+t,a.object["@type"]="Link",a.object.name=e,a.object.displayName=e,a.schema.target={"@id":this.getUrnIdWithContentType(n,r),"@type":r},new i(a,["object","target"])},n.prototype.trackSocial=function(t,e,r){var n=new o(this.activity);return n.type=r||"Like",n.origin=this.addPageStandards(n.origin),n.object["@id"]=this.getUrnIdWithContentType()+":element:"+t,n.object["@type"]="Link",n.schema.target={"@id":"urn:"+e.toLowerCase()+":action:"+n.type.toLowerCase(),"@type":"Service"},new i(n,["object","origin","target"])},n.prototype.trackMediaState=function(t,e,r){var n=new o(this.activity);return n.type=r||"Watch",n.object={"@type":e,"@id":this.getUrnIdWithContentType()+":"+e+":"+t},n.origin=this.addPageStandards(n.origin),new i(n,["object","origin"])},n.prototype.trackScroll=function(t,e){var r=new o(this.activity);return r.type=e||"Arrive",r.object=this.addPageStandards(r.object),r.schema.result={"@type":"Place","@id":this.getUrnIdWithContentType()+":scroll:"+t,"spt:depth":t},new i(r,["object","result"])},n.prototype.trackVisibility=function(t,e,r){var n=new o(this.activity);if("undefined"==typeof e)throw new Error("No time parameter was passed to this function");return n.type=r||"View",n.origin=this.addPageStandards(n.origin),n.object={"@type":"Content","@id":this.getUrnIdWithContentType()+":element:"+t},e.start?n.object.startTime=e.start:e&&!e.end&&(n.object.startTime=e),e.end&&(n.object.endTime=e.end),new i(n,["origin","object"])},n.prototype.trackExit=function(t,e,r){var n=new o(this.activity);return n.type=r||"Leave",n.object=this.addPageStandards(n.object),n.schema.target={},"undefined"!=typeof t&&"undefined"!=typeof e&&(n.schema.target={"@type":e,"@id":this.getUrnIdWithContentType(t,e)}),new i(n,["object","target"])},n.prototype.trackEngagement=function(t,e,r,n,s,a,c){var u,p=new o(this.activity);if(p.schema.schema="http://schema.schibsted.com/events/engagement-event.json/16.json#",p.type="Engagement",p.origin=this.addPageStandards(p.origin),c){if(u=c,"string"==typeof c)try{u=JSON.parse(c)}catch(l){p.activity.opts.debugMode&&console.log("Error parsing JSON: "+l)}"object"==typeof u&&p.addCustomDataToProperty(p.object,u)}return n&&s?(p.object["@id"]=p.origin["@id"]+":"+n+":"+s,p.object["@type"]=n,p.object.action=a):p.object=this.addPageStandards(p.object),t||0===t?p.schema.duration=t:p.schema.duration=this.activity.utils.getViewDuration(),e||0===e?p.schema.scrollPosition=e:p.schema.scrollPosition=this.activity.utils.getScrollPosition(),p.schema.action=r,new i(p,["object"])},n.prototype.trackEngagementTime=function(t,e,r){return this.trackEngagement(t,r)},n.prototype.trackCustomEvent=function(t,e,r){var n=new o(this.activity);return n.type=e||"Custom",n.object=this.addPageStandards(n.object),"object"==typeof r&&n.addCustomDataToProperty(n.object["spt:custom"],r),t&&(n.provider.eventIdentifier=t),new i(n,["object"])},n.prototype.trackCustom=function(t,e){var r=new o(this.activity);return r.type=t&&!~t.indexOf("custom:")?"custom:".concat(t):t||"custom:Content",r.object=this.addPageStandards(r.object),r.schema.schema="http://schema.schibsted.com/events/custom-event.json/0.json#","object"==typeof e&&(r.custom=e),new i(r,["object"])},n.prototype.addPageStandards=function(t,e,r){return e=e||this.activity.contentId,r=r||this.activity.contentType,t=t||{},t["@type"]=r,String(this.activity.contentId).indexOf("urn:")>-1?t["@id"]=e:t["@id"]=this.getUrnIdWithContentType(e,r),t.contentId=e,t.url=document.URL,t.name=document.title,t.displayName=document.title,this.opts.inLanguage&&(t.inLanguage=this.opts.inLanguage),this.opts.tags&&s.isArray(this.opts.tags)&&(t.tags=this.opts.tags),this.validateAndSet(t,"adType",this.opts.adType,"string"),this.validateAndSet(t,"location",this.opts.contentLocation,"object"),this.validateAndSet(t,"publisher",this.opts.publisher,"object"),this.validateAndSet(t,"publisherType",this.opts.publisherType,"string"),this.validateAndSet(t,"images",this.opts.images,"object"),this.validateAndSet(t,"published",this.opts.published,"string"),this.validateAndSet(t,"price",this.opts.price),this.validateAndSet(t,"currency",this.opts.currency,"string"),this.validateAndSet(t,"items",this.opts.items,"object"),this.addCategoryToEvents(t)},n.prototype.validateAndSet=function(t,e,r,n){if(e&&r)return n&&typeof r!==n?(console.log("not valid"+e+" : "+n),void(this.activity.opts.debugMode&&console.log(e+" is not of type "+n))):void(t[e]=r)},n.prototype.addCategoryToEvents=function(t){var e=this.activity.opts,r="";
return e.provider=e.provider||{},e.object=e.object||{},e.category?r=e.category:e.object.category?r=e.object.category:e.provider.category&&(r=e.provider.category),s.isArray(r)&&(r=r.toString()),r&&(t.category=r),t},n.prototype.getUrnIdWithContentType=function(t,e){var r,n,i=t||this.activity.contentId;return String(i).indexOf("urn:")===-1?(r=e||this.activity.contentType,n=this.getDomainFromUrl(document.URL),"urn:"+n+":"+r.toLowerCase()+":"+i):i},n.prototype.getDomainFromUrl=function(t){var e=t.match(/^https?\:\/\/(www.)?([^\/:?#]+)(?:[\/:?#]|$)/i);return e&&e[2]},n.prototype.reMapCustom=function(t,e,r){return r!==!1&&(r=!0),this.opts.object&&this.opts.object.properties&&this.opts.object.properties[e]?(t[e]=this.opts.object.properties[e],r&&delete this.opts.object.properties[e],t):t},t.exports=n},function(t,e){"use strict";function r(t,e){if(!t)throw new Error("data required");try{this.data=t.getSchema()}catch(r){throw new Error("get schema function required")}if(!t.activity)throw new Error("data must have property activity");this.activity=t.activity,this.objectOrder=e||[]}r.prototype.queue=function(){this.activity.queue.push(this.data)},r.prototype.send=function(t){this.activity.send(this.data,t)},r.prototype.addProperty=function(t,e,r){var n=this.getObjectKey(t);return this.data[n][e]=r,this},r.prototype.addCustomData=function(t,e){var r=this.getObjectKey(t);return this.data[r]["spt:custom"]=e,this},r.prototype.getObjectKey=function(t){if("primary"===t)return this.objectOrder[0];if("secondary"===t)return this.objectOrder[1];if("tertiary"===t)return this.objectOrder[2];throw new Error("Object reference not valid")},t.exports=r},function(t,e,r){"use strict";function n(t,e){if(!t)throw new Error("Activity needed");this.activity=t,this.reducedEvent=e,this.schema={},this.type=null,this.actor={},this.device={},this.provider={},this.object={},this.origin={},this.location={},this.tracker={},this.initSchema()}var i=r(45);n.prototype.initSchema=function(){this.schema["@id"]=i.getUuidV4(),this.schema["spt:pageViewId"]=this.activity.pageViewId,this.schema.published=i.getTimestamp(),this.schema.schema="http://schema.schibsted.com/events/base-event.schema.json/25.json",this.createActor(),this.createTracker(),this.createDevice(),this.createProvider(),this.createObject(),this.createOrigin(),this.createLocation(),this.addCustomData()},n.prototype.populateSchema=function(){this.schema["@type"]=this.type,this.schema.actor=this.actor,this.schema.tracker=this.tracker,this.schema.device=this.device,this.schema.provider=this.provider,this.schema.object=this.object,this.schema.origin=this.origin,this.schema.location=this.location,this.target&&(this.schema.target=this.target),this.result&&(this.schema.result=this.result),this.scrollPosition&&(this.schema.scrollPosition=this.scrollPosition),this.duration&&(this.schema.duration=this.duration),this.custom&&(this.schema.custom=this.custom)},n.prototype.createDevice=function(){this.device.deviceType=i.getDeviceType(navigator.userAgent)},n.prototype.createObject=function(){this.object["spt:custom"]={}},n.prototype.createOrigin=function(){},n.prototype.createTracker=function(){this.tracker.version=this.activity.version,this.tracker.type="JS",this.activity.user&&this.activity.user.localCookieNotSet&&(this.tracker.localCookieNotSet=!0);try{this.checkLocalStorage()}catch(t){this.tracker.localStorageNotSet=!0}this.reducedEvent||this.extendedTrackerData()},n.prototype.extendedTrackerData=function(){this.tracker.performance={},this.tracker.performance.pulse2=this.activity.pulse2timing,this.tracker.name="Pulse v2 tracker JS SDK",window&&window.performance&&(this.tracker.performance.browser={},this.tracker.performance.browser=window.performance.timing)},n.prototype.createLocation=function(){this.activity.opts&&this.activity.opts.location&&(this.location["@type"]="Place",this.location.latitude=this.activity.opts.location.latitude,this.location.longitude=this.activity.opts.location.longitude,this.location.accuracy=this.activity.opts.location.accuracy)},n.prototype.createActor=function(){this.actor["@type"]="Person",this.reducedEvent||this.extendedActorData()},n.prototype.extendedActorData=function(){this.actor["spt:userAgent"]=navigator.userAgent,this.actor["spt:screenSize"]=window.screen.width+"x"+window.screen.height,this.actor["spt:viewportSize"]=i.getViewportDimensions(),this.actor["spt:acceptLanguage"]=i.getDeviceLanguage()},n.prototype.createProvider=function(){this.provider["@type"]="Organization",this.provider["@id"]=this.activity.clientId,this.provider.url=document.URL,this.provider.productType=this.activity.opts.productType,this.provider.component=this.activity.opts.component},n.prototype.addCustomData=function(){this.activity.opts&&(this.addCustomDataToProperty(this.provider,this.activity.opts.provider),this.addCustomDataToProperty(this.object["spt:custom"],this.activity.opts.object))},n.prototype.addCustomDataToProperty=function(t,e){var r;for(r in e)t.hasOwnProperty(r)||(t[r]=e[r])},n.prototype.getSchema=function(){return this.populateSchema(),this.schema},n.prototype.getString=function(){return JSON.stringify(this.getSchema())},n.prototype.checkLocalStorage=function(){localStorage.setItem("pulse2-val","check"),localStorage.removeItem("pulse2-val")},t.exports=n},function(t,e){"use strict";t.exports.retry=function(t,e,r){var n,i=1;if(!t||"number"!=typeof t)throw new Error("times required");if(!e||"function"!=typeof e)throw new Error("task required");if(!r||"function"!=typeof r)throw new Error("callback required");n=function(){arguments[0]&&i>=t?r.apply(null,arguments):arguments[0]?(i+=1,e(n)):r.apply(null,arguments)},e(n)},t.exports.getViewportDimensions=function(){var t,e;return"undefined"!=typeof window.innerWidth?(t=window.innerWidth,e=window.innerHeight):"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):(t=document.getElementsByTagName("body")[0].clientWidth,e=document.getElementsByTagName("body")[0].clientHeight),t+"x"+e},t.exports.getDeviceLanguage=function(){var t;return navigator.userLanguage?t=navigator.userLanguage:navigator.language&&(t=navigator.language),t},t.exports.getDeviceType=function(t){var e={mobile:["iPhone;","iPod;","iPod touch;","^HTC","Fennec","IEMobile","BB10;","BlackBerry","SymbianOS.*AppleWebKit","^Mozilla.*Mobile.*Firefox","^Mozilla.*Chrome.*Mobile","Opera Mobi","Android.*Mobile","Android.*Mini","Symbian","^SonyEricsson","^Nokia","^SAMSUNG","^LG"],tablet:["iPad;","Android"]},r=function(e){var r,n=0;for(n;n<e.length;n++)if(r=e[n],t.match(new RegExp(r)))return!0;return!1};if(t){if(r(e.mobile))return"mobile";if(r(e.tablet))return"tablet"}return"desktop"},t.exports.getTimestamp=function(){var t=new Date,e=-t.getTimezoneOffset(),r=e>=0?"+":"-",n=function(t){var e=Math.abs(Math.floor(t));return(e<10?"0":"")+e},i=t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate());return i=i+"T"+n(t.getHours())+":"+n(t.getMinutes()),i=i+":"+n(t.getSeconds()),i=i+r+n(e/60)+":"+n(e%60)},t.exports.getUuidV4=function(){var t,e,r="";for(e=0;e<36;e++)t=14===e?4:19===e?Math.floor(4*Math.random()+8).toString(16):8===e||13===e||18===e||23===e?"-":Math.floor(16*Math.random()).toString(16),r+=t;return r},t.exports.getUrlParams=function(t){var e,r,n=[],i=location.search,o=i.split("&"),s=new RegExp(t+"=([^&;]+?)(&|#|;|$)","i");for(r=0;r<o.length;r++)e=o[r].match(s),e&&n.push(e[1]);return n},t.exports.getQueryVariable=function(t){var e,r,n,i=window.location.search.substring(1),o=i.split("&");for(e=0;e<o.length;e++)if(r=o[e].split("="),r[0]===t)return r[1];for(o=i.split("&amp"),e=0;e<o.length;e++)if(n=o[e].split("="),n[0]===t)return n[1]},t.exports.getScrollPosition=function(){return(window.pageYOffset||document.scrollTop)-(document.clientTop||0)},t.exports.getViewDuration=function(){var t,e,r;if(!window.performance)return null;t=window.performance.timing.domLoading,e=(new Date).getTime();try{r=e-t}catch(n){r=null}return r},t.exports.checkLocalStorage=function(){localStorage.setItem("pulse2-val","check"),localStorage.removeItem("pulse2-val")},t.exports.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.exports.objectKeys=function(t){var e,r,n=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=o.length,a=[];if("object"!=typeof t&&("function"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");for(e in t)n.call(t,e)&&a.push(e);if(i)for(r=0;r<s;r++)n.call(t,o[r])&&a.push(o[r]);return a},t.exports.dateNow=function(){return(new Date).getTime()}},function(t,e,r){"use strict";function n(t){t=t||{},this.idObj={},this.cookieKey="_pulse2data",this.cookiesAllowed=navigator.cookieEnabled,this.localCookieNotSet=!1,this.anonIdPlaceholder="x",this.opts=t,this.userIdDomain=t.userIdDomain||"schibsted.com",this.userId=this.opts.userId,this.userId||(delete this.userId,delete this.opts.userId),this.visitorIdPlaceholder="v",this.redirectString="https://cis.schibsted.com/redirect/?redirectUrl="+document.location,this.userServiceUrl=t.userServiceUrl||s.envVars.userServiceUrl,this.transport=t.transport||new i,this.utils=o,this.noRedirect=!0,this.doValidation=!1,this.shouldSyncWithAn=!1,this.shouldFetchFromAn=!1,this.hasCookie=!1,this.anSyncUrl="https://secure.adnxs.com/getuidj",this.doTracking=!0,this.anSyncStatus="nothing has happened",this.didSync=!1,"undefined"!=typeof t.noRedirect&&(this.noRedirect=t.noRedirect)}var i=r(47),o=r(45),s={};try{s=r(48)}catch(a){s=r(49)}n.prototype.getUserId=function(t){var e,r=this;return t=t||function(){},e=this.getIdsFromCookie(),this.userId&&(e.userId=this.createUserIdWithUrn(this.userId)),this.mapUserData(e),this.idObj.envId?t(null,r.idObj):this.syncIdsWithServer(t)},n.prototype.syncIdsWithServer=function(t){var e=this;!this.idObj.envId||this.userStatusHasChanged()||this.doValidation||setTimeout(function(){e.doAppNexusSync()},2e3),this.doValidation!==!0&&this.idObj.envId||this.didSync!==!1||(this.didSync=!0,this.getIdsFromService(this.idObj,function(r,n){return e.onIdServiceResponse(r,n,t)})),this.doValidation=!1,this.doAppNexusSync(null,function(){return t(null,e.idObj)})},n.prototype.mapUserData=function(t){var e,r,n=["undefined","false","0","","null"];this.idObj.userId=t.userId||this.idObj.userId,this.idObj.envId=t.environmentId||t.envId,this.idObj.prevUserId=t.prevUserId,this.idObj.anId=t.anId||this.idObj.anId,this.idObj.jweIds=t.jwe||this.idObj.jweIds,this.idObj.pixelInjected=t.pixelInjected||null,this.idObj.adId=t.adId||this.idObj.adId||null,t.doAnSync&&(this.shouldSyncWithAn=t.doAnSync),this.doTracking=this.resolveDoTracking(t.doTracking),this.idObj.userId&&(e=this.idObj.userId.split(":"),r=e[e.length-1],n.indexOf(r)>=0&&delete this.idObj.userId),this.setIdsInCookie()},n.prototype.setIdsInCookie=function(){var t,e,r=this.idObj.userId||this.anonIdPlaceholder,n=new Date,i=new Date,o=new Date,s=n.getTime();this.idObj.envId&&(n.setTime(s+9e5),i.setTime(s+144e5),o.setTime(s+63072e6),t=[this.idObj.envId,this.visitorIdPlaceholder,r,n.getTime(),this.idObj.jweIds,this.idObj.anId,i.getTime(),this.doTracking.toString(),this.idObj.pixelInjected,this.idObj.adId],this.writeCookie(t,document.domain,o.toUTCString()),e=this.getCookie(this.cookieKey),e||(this.localCookieNotSet=!0))},n.prototype.writeCookie=function(t,e,r){var n;n=this.cookieKey+"="+t,n+=";domain="+e,n+=";path=/",n+=";expires="+r,document.cookie=n},n.prototype.getIdsFromCookie=function(){var t,e,r=this.getCookie(this.cookieKey);return r&&r.indexOf("undefined")===-1?(t=r.split(","),t.length<2?(this.deleteCookie(this.cookieKey),{}):(t[3]&&this.utils.dateNow()>parseInt(t[3],10)&&(this.doValidation=!0,this.hasCookie=!0),t[6]&&this.utils.dateNow()>parseInt(t[6],10)&&(this.shouldSyncWithAn=!0,this.doValidation=!1),t[5]&&"unresolved"!==t[8]||(t[8]="unresolved",this.shouldFetchFromAn=!0),e={environmentId:t[0],prevUserId:t[2],jwe:t[4],anId:t[5],doTracking:t[7],pixelInjected:t[8],adId:t[9]})):(this.deleteCookie(this.cookieKey),this.shouldSyncWithAn=!0,{})},n.prototype.getCookie=function(t){var e=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||!1;return e},n.prototype.deleteCookie=function(t){document.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT"},n.prototype.getIdsFromService=function(t,e){var r=this.userServiceUrl,n=this,i=3,o={environmentId:t.envId,userId:t.userId,jwe:t.jweIds};t.anId&&(o.anId=t.anId),this.opts.waitForOptOut&&(o.waitForOptOut=this.opts.waitForOptOut),this.hasCookie&&(i=1),this.transport.post(r,o,function(t,r){var i;return t?void e(t):(i=JSON.parse(r.response||r.responseText),i.data.anid&&"0"!==i.data.anid||(i.data.doAnSync=!0),n.mapUserData(i.data),void e(null,i.data))},!0,i)},n.prototype.onIdServiceResponse=function(t,e,r){return this.hasCookie?(this.hasCookie=!1,r(null,this.idObj)):(t&&r(t),r(null,this.idObj))},n.prototype.userStatusHasChanged=function(){var t=this.idObj.userId,e=this.idObj.prevUserId;return!!e&&(t&&e!==t.toString()||!t&&e!==this.anonIdPlaceholder)},n.prototype.doAppNexusSync=function(t,e){var r=this;return e=e||function(){},this.shouldFetchFromAn?(this.shouldFetchFromAn=!1,void this.transport.get(this.anSyncUrl,null,function(t,n){var i;return t?e(t,n):(i=JSON.parse(n.response||n.responseText),r.idObj.anId=i.uid,r.mapUserData(r.idObj),r.setAnIdResolved(),r.getIdsFromService(r.idObj,function(t,n){return r.onIdServiceResponse(t,n,e)}),e())},1,!0)):t},n.prototype.setAnIdUnresolved=function(){this.idObj.pixelInjected="unresolved",this.setIdsInCookie(this.idObj)},n.prototype.setAnIdResolved=function(){this.idObj.pixelInjected=null,this.setIdsInCookie(this.idObj)},n.prototype.getTheUserId=function(){return this.createUserIdWithUrn(this.idObj.userId)},n.prototype.getTheEnvironmentId=function(){return this.idObj.envId},n.prototype.getTheJweIds=function(){return this.idObj.jweIds},n.prototype.getTheAdId=function(){return this.idObj.adId},n.prototype.createUserIdWithUrn=function(t,e){return!t||String(t).indexOf("undefined")>-1?e:String(t).indexOf("urn:")>-1?t:"urn:"+this.userIdDomain+":user:"+t},n.prototype.resolveDoTracking=function(t){return t===!0||"true"===t||1===t||t!==!1&&"false"!==t&&0!==t&&this.doTracking},t.exports=n},function(t,e,r){"use strict";function n(){this.utils=i}var i=r(45);n.prototype.getUrlWithCorrectProtocol=function(t){var e=t.split("://");return"//"+e.pop()},n.prototype.getXHR=function(t,e,r){var n;return"undefined"!=typeof XDomainRequest?(n=new XDomainRequest,n.open(e.toLowerCase(),this.getUrlWithCorrectProtocol(r)),n):(n=new XMLHttpRequest,"withCredentials"in n&&(n.open(e,r),n.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),t&&(n.withCredentials=!0),n))},n.prototype.addDataToUrl=function(t,e){var r,n;if(!e||"object"!=typeof e)return t;for(r=i.objectKeys(e);r&&"object"==typeof e[r[0]];)r.shift();for(t=this.appendParameterToUrl(t,r[0],e[r[0]],"?"),n=1;n<r.length;n++)t=this.appendParameterToUrl(t,r[n],e[r[n]],"&");return t},n.prototype.appendParameterToUrl=function(t,e,r,n){return"object"!=typeof r?t+n+encodeURIComponent(e)+"="+encodeURIComponent(r):t},n.prototype.post=function(t,e,r,n,i){return t?e&&"object"==typeof e?(n=n||!1,void this.send(t,e,r,n,i,"POST")):r("data required"):r("url required")},n.prototype.get=function(t,e,r,n,i){return t?(e&&(t=this.addDataToUrl(t,e)),void this.send(t,e,r,i,n,"GET")):r("url required")},n.prototype.send=function(t,e,r,n,i,o){var s=this;if(!r)throw new Error("callback required");i=i||3,this.utils.retry(i,function(r){var i=s.getXHR(n,o,t);if(i||r("Failed to identify request method"),"undefined"!=typeof XDomainRequest?(i.onload=function(){r(null,i)},i.onprogress=function(){},i.onerror=function(){r("Failed request"),i.abort()},i.ontimeout=i.onerror):i.onreadystatechange=function(){4===i.readyState&&(200===i.status?r(null,i):r("Failed with status "+i.status))},"POST"===o)try{i.send(JSON.stringify(e))}catch(a){r(a.name+": "+a.message)}else if("GET"===o)try{i.send()}catch(a){r(a)}},r)},t.exports=n},function(t,e){"use strict";t.exports.envVars={dataCollectorUrl:"https://collector.schibsted.io/api/v1/track",userServiceUrl:"https://cis.schibsted.com/api/v1/identify",errorReportingUrl:""}},function(t,e){"use strict";t.exports.envVars={dataCollectorUrl:"http://127.0.0.1:8002/api/v1/track",userServiceUrl:"https://cis.schibsted.com/api/v1/identify",errorReportingUrl:""}},function(t,e){"use strict";function r(t,e,r){this.collectorBaseUrl=t,this.service=e||"pulse2",this.clientId="",this.pageViewId="",this.throttle=.1,r>=0&&(this.throttle=r)}r.prototype.initPulsePixel=function(t,e){this.clientId=e,this.pageViewId=t,this.collectorBaseUrl=this.getImageTrackingUrl(this.collectorBaseUrl),this.createPulsePixelUrl(),this.initPixel()},r.prototype.initPixel=function(){Math.random()<this.throttle&&this.collectorBaseUrl&&this.injectPixel()},r.prototype.createPulsePixelUrl=function(){var t="?provider.@id="+this.clientId;t+="&service="+this.service,t+="&@type=Pixel",t+="&@id="+this.pageViewId,this.collectorBaseUrl+=t},r.prototype.injectPixel=function(){var t=this.createImgElement(),e=document.getElementsByTagName("body");e.item(0).appendChild(t)},r.prototype.getImageTrackingUrl=function(t){var e="",r=/\/api\/v[0-9]\/track$/;try{e=t.replace(r,"/img")}catch(n){return}if(t!==e&&e)return e},r.prototype.createImgElement=function(){var t=document.createElement("img");return t.src=this.collectorBaseUrl,t.id=this.service+"pixel",t.style.visibility="hidden",t},t.exports=r},function(t,e,r){"use strict";function n(t){if(!t)throw new Error("size of the queue must be given");this.maxSize=t,this.queue=[]}var i=r(45);n.prototype.push=function(t){this.queue.push(t),this.queue.length>this.maxSize&&this.queue.shift()},n.prototype.pushMany=function(t){if(!i.isArray(t))throw new Error("elements must be an array");this.queue=this.queue.concat(t),this.queue.length>this.maxSize&&(this.queue=this.queue.slice(this.queue.length-this.maxSize,this.queue.length))},n.prototype.pull=function(){return this.queue.shift()},n.prototype.pullAll=function(){return this.queue.splice(0,this.queue.length)},n.prototype.peek=function(){return this.queue[0]},n.prototype.peekAll=function(){return this.queue},n.prototype.count=function(){return this.queue.length},t.exports=n},function(t,e,r){"use strict";function n(t){this.opts=t,this.plugins=window.pulse2plugins||[],this.hooks={eventCreated:this.plugins.eventCreatedHooks||[],eventReady:this.plugins.eventReadyHooks||[],eventSent:this.plugins.eventSentHooks||[],load:this.plugins.onLoadHooks||[],ready:this.plugins.onReadyHooks||[]},this.sdkReady="ready",this.sdkLoad="load",this.eventCreated="eventCreated",this.eventReady="eventReady",this.eventSent="eventSent"}var i=r(45);n.prototype.call=function(t,e){switch(t){case this.eventCreated:case this.eventReady:case this.eventSent:return this.callEventHooks(e,this.hooks[t]);case this.sdkReady:case this.sdkLoad:return this.callSdkHooks(e,this.hooks[t]);default:return}},n.prototype.callEventHooksArray=function(t,e){var r,n=[];for(r=0;r<t.length;r++)n.push(this.callEventHooks(t[r],e));return n},n.prototype.callEventHooks=function(t,e){var r,n,o,s;if(e=e||[],i.isArray(t))return this.callEventHooksArray(t,e);if(!t["@type"])return t;for(s=0;s<e.length;s++)if(r=e[s],n=i.objectKeys(r)[0].toLowerCase(),"all"===n||n===t["@type"].toLowerCase())try{o=r[n](t),o&&(t=o)}catch(a){this.opts.debugMode&&console.log("plugins.js: A pulse2 sdk plugin failed: "+a)}return t},n.prototype.callSdkHooks=function(t,e){var r;if("object"==typeof e&&"object"==typeof t)for(r=0;r<e.length;r++)try{e[r](t)}catch(n){this.opts.debugMode&&console.log("plugins.js: A pulse2 event plugin failed: "+n)}},n.prototype.on=function(t,e,r){var n={};t&&e&&(r?n[r]=e:n=e,this.hooks[t].push(n))},t.exports=n},function(t,e){"use strict";function r(t){this.activity=t,this.plugins=this.activity.plugins,this.registerTriggers()}r.prototype.registerTriggers=function(){this.plugins.on(this.plugins.sdkLoad,this.getUrlTriggers)},r.prototype.getUrlTriggers=function(t){var e,r,n,i,o,s,a=t.utils.getUrlParams("p2param");for(r=0;r<a.length;r++){for(s={},i=a[r].split("."),n=i.slice(2),o=0;o<n.length;o++)try{n[o]=n[o].split("_"),s[n[o][0]]=n[o][1]}catch(c){this.activity.opts.debugMode&&console.log("trigger.js: An error occurred while reading URL param: "+c)}e=t.events.trackCustomEvent(null,i[0],s),e.data.object.displayName=i[1],e.data.object["@id"]+=":elementId:"+i[1],e.send()}},t.exports=r},function(t,e,r){"use strict";function n(t){return t<10?"0"+t:t}t.exports.requireOpts=function(t,e){for(var r=0;r<e.length;r++)if(!t[e[r]])throw new Error(e[r]+" is required")},t.exports.windowHeight=function(){return window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight},t.exports.windowWidth=function(){return window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth},t.exports.documentHeight=function(){var t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)},t.exports.getUnixTimestamp=function(t){return t=t?(new Date).getTime(t):(new Date).getTime(),Math.round(t/1e3)},t.exports.isoToDate=function(t){var e=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/,r=e.exec(t);if(!r)throw new Error("Not ISO8601 date "+t);r={year:r[1],month:r[2],day:r[3],hour:r[4],minutes:r[5],seconds:r[6],ms:r[7],zoneUTC:r[8],zoneModifier:r[9],zoneHours:r[10],zoneMinutes:r[11]};for(var n=["month","hour","minutes","seconds","ms","zoneHour","zoneMinutes"],i=0;i<n.length;i++)r[n[i]]=Number(r[n[i]])||0;r.month=(Number(r.month)||1)-1,r.day=Number(r.day)||1;var o=0;return"Z"!==r.zoneUTC&&"undefined"!=typeof r.zoneModifier&&(o=60*r.zoneHours+r.zoneMinutes,"+"===r.zoneModifier&&(o=0-o)),new Date(Date.UTC(r.year,r.month,r.day,r.hour,r.minutes+o,r.seconds,r.ms))},t.exports.dateToISO=function(t){return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},t.exports.bind=function(t,e,r){t.addEventListener?t.addEventListener(e,r):t.attachEvent("on"+e,r)},t.exports.unbind=function(t,e,r){t.removeEventListener?t.removeEventListener(e,r):t.detachEvent("on"+e,r)},t.exports.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},t.exports.getDomainFromUrl=function(t){var e=document.createElement("a");return e.setAttribute("href",t),e.hostname},t.exports.prepend=function(t,e){return t?0!==t.indexOf(e)?e+t:t:e},t.exports.normalizeUrl=function(t){if(0===t.indexOf("http:")||0===t.indexOf("https:")){var e=document.createElement("a");e.setAttribute("href",t);var r=e.hostname.split(".");return"www"===r[0]&&(r=r.slice(1)),r.join(".")+this.prepend(e.pathname,"/")+e.search+e.hash}return t},t.exports.urlExists=function(t){return t&&t.length>0},t.exports.sdrn=function(t,e,r){var n=!1;return n?0===r.toString().indexOf("sdrn:")?r:["sdrn",t,e,encodeURIComponent(r)].join(":"):r}},function(t,e,r){"use strict";function n(t){i(this,t)}var i=r(8),o=r(54),s=r(56);n.prototype.setMetadata=function(t,e,r){if(o.requireOpts(r,["published"]),!r.articleId){if(!r.previewUrl||!r.previewUrl.http)throw new Error("previewUrl.http is required when articleId is missing");if(!r.previewUrl||!r.previewUrl.https)throw new Error("previewUrl.https is required when articleId is missing")}if(r.group&&r.group.length>256)throw new Error("Group can not be longer then 256 characters");if(r.articleContainer&&!r.articleContainer.nodeName)throw new Error("articleContainer must be a DOM node");!r.updated||r.updated instanceof Date?this.updated=r.updated||null:this.updated=o.isoToDate(r.updated),r.published instanceof Date?this.published=r.published:this.published=o.isoToDate(r.published),i(this,e),i(this,{articleId:r.articleId||o.normalizeUrl(e.permalink),category:r.category||null,group:r.group||null,authors:r.authors||[],wordCount:r.wordCount||null,scrollContainer:r.scrollContainer||null,articleContainer:r.articleContainer||null,previewUrl:r.previewUrl});var n=t.evaluateReferringArticle();this.isReferrerArticle=!!n,this.referrerId=n?n.articleId:t.getReferrer(),this.previousReferrer=n?n.referrer:null;var s=t.evaluateReferringPage();if(s&&(this.isReferrerArticle=!1,this.referrerId=s.pageId||t.getReferrer(),this.previousReferrer=s.referrer||null,s.experiments&&s.experiments.length)){this.experiments=this.experiments||[];for(var a=0;a<s.experiments.length;a++)this.experiments.push(s.experiments[a])}var c=t.evaluateReferringExperiment();c&&(this.experiments=this.experiments||[],this.experiments.push(c.experiment));var u=t.evaluateReferringImpression();u?this.referringImpression=u.impression:this.referringImpression=null,t.setArticle(this)},n.prototype.setPulseMetadata=function(t){t.contentId=o.sdrn(this.site,"article",this.articleId),t.contentType="Article",t.tags=this.tags;var e=null;return this.category&&!o.isNumeric(this.category)&&(e=this.category),t.category=e,t},n.prototype.view=function(t,e,r){var n;n=this.updated?o.dateToISO(this.updated):null;var i={"spt:site":this.site,"spt:url":e.getUrl(),"spt:articleId":this.articleId,"spt:group":this.group,"spt:device":this.device,"spt:permalink":this.permalink,"spt:shareUrl":this.shareUrl,"spt:previewUrl":this.previewUrl,"spt:published":o.dateToISO(this.published),"spt:updated":n,"spt:authors":this.authors,"spt:wordCount":this.wordCount,"spt:imageUrl":this.imageUrl,"spt:referrer":e.getReferrer(),"spt:isReferrerArticle":this.isReferrerArticle,"spt:referrerId":this.referrerId,"spt:previousReferrer":this.previousReferrer,"spt:engageSdkVersion":r,"spt:referringImpression":this.referringImpression},s=t.events.trackContentView(this.title);this.experiments&&(s.data.experiments=this.experiments),s.addCustomData("primary",i).send()},n.prototype.getReferrerInfo=function(t){return{referrer:t.getReferrer(),isReferrerArticle:this.isReferrerArticle,referrerId:this.referrerId,previousReferrer:this.previousReferrer}},n.prototype.createEngagementTime=function(t,e){this.engagementTime||(this.engagementTime=new s(t,{contentType:t.contentType,articleId:this.articleId,pageViewId:t.getPageViewId(),device:this.device,group:this.group,wordCount:this.wordCount,url:e.getUrl(),referrerInfo:this.getReferrerInfo(e),scrollContainer:this.scrollContainer,articleContainer:this.articleContainer},this.experiments),this.engagementTime.initialize())},n.prototype.updateEngagementTime=function(t,e,r){this.engagementTime&&(this.engagementTime.setGroup(this.group),this.engagementTime.setWordCount(this.wordCount),this.engagementTime.setUrl(e.getUrl()),this.engagementTime.setReferrerInfo(this.getReferrerInfo(e)),this.engagementTime.setExperiments(this.experiments),this.engagementTime.setScrollContainer(this.scrollContainer),this.engagementTime.setArticleContainer(this.articleContainer),r&&(this.engagementTime.setArticleId(this.articleId),this.engagementTime.setPageViewId(t.getPageViewId()),this.engagementTime.reset()))},n.prototype.createImpressions=function(){},n.prototype.destroy=function(){this.engagementTime&&(this.engagementTime.destroy(),this.engagementTime=null)},t.exports=n},function(t,e,r){"use strict";function n(t,e){if(!t)throw new Error(e+" is required")}function i(t,e,r){e=e||{},n(t,"Pulse client"),n(e.articleId,"articleId"),n(e.contentType,"contentType"),n(e.pageViewId,"pageViewId"),n(e.device,"device"),n(e.referrerInfo,"referrerInfo"),n(e.url,"url"),this.pulse=t,this.initialTimeInMs=Date.now(),this.contentType=e.contentType,this.articleId=e.articleId,this.pageViewId=e.pageViewId,this.device=e.device,this.group=e.group,this.wordCount=e.wordCount||null,this.url=e.url,this.referrerInfo=e.referrerInfo,this.experiments=r,this.scrollContainer=e.scrollContainer||null,this.articleContainer=e.articleContainer||null,this.scrollPosition=0,this.articleViewedPercentage=null,this.totalActiveTime=0,this.lastActiveTime=u.getUnixTimestamp(),this.lastPingSent=this.lastActiveTime,this.activityInterval=null,this.windowEventTypes=["focus","resize"],this.bodyEventTypes=["beforeunload","focus","mousemove","mousedown","keydown"],this.throttledUpdateActivity=s(o(this.updateActivity,500),this),this.latestEngagementData=null}var o=r(57),s=r(60),a=r(37),c=r(79),u=r(54),p="7.16.0",l=!1,h=5,d=5;i.prototype.initialize=function(){l&&this.sendStoredEvents(),this.storeActivity(),this.trackActivity(),this.initializePings()},i.prototype.trackActivity=function(){var t;for(t=0;t<this.windowEventTypes.length;t++)u.bind(window,this.windowEventTypes[t],this.throttledUpdateActivity);for(t=0;t<this.bodyEventTypes.length;t++)u.bind(document.body,this.bodyEventTypes[t],this.throttledUpdateActivity);this.trackScrollActivity(),this.trackReadingTime(h)},i.prototype.trackScrollActivity=function(){u.bind(this.scrollContainer||window,"scroll",this.throttledUpdateActivity)},i.prototype.untrackScrollActivity=function(){u.unbind(this.scrollContainer||window,"scroll",this.throttledUpdateActivity)},i.prototype.trackReadingTime=function(t){var e=1;this.activityInterval=window.setInterval(s(function(){this.lastActiveTime<u.getUnixTimestamp()-t||(this.totalActiveTime+=e,this.storeActivity())},this),1e3*e)},i.prototype.updateActivity=function(){this.lastActiveTime=u.getUnixTimestamp(),this.updateScrollPosition(),this.storeActivity()},i.prototype.updateScrollPosition=function(){var t=(window.pageYOffset||document.scrollTop)-(document.clientTop||0);if(t>this.scrollPosition&&(this.scrollPosition=t),this.articleContainer){var e=Math.round(100/this.articleContainer.offsetHeight*c(this.articleContainer));e>this.articleViewedPercentage&&e<=100&&(this.articleViewedPercentage=e)}},i.prototype.storeActivity=function(){if(this.latestEngagementData={articleId:this.articleId,contentType:this.contentType,pageViewId:this.pageViewId,group:this.group,scrollPosition:this.scrollPosition,articleViewedPercentage:this.articleViewedPercentage,totalActiveTime:this.totalActiveTime,referrerInfo:this.referrerInfo,wordCount:this.wordCount,url:this.url},l){var t=a.get("engage:engagement")||{};t[this.pageViewId]=this.latestEngagementData,a.set("engage:engagement",t)}},i.prototype.initializePings=function(){this.pingInterval=window.setInterval(s(function(){this.lastPingSent!==this.lastActiveTime&&(this.lastPingSent=this.lastActiveTime,this.sendEvent(this.latestEngagementData))},this),1e3*d)},i.prototype.sendStoredEvents=function(){var t=a.get("engage:engagement");if(t){a.set("engage:engagement");for(var e in t)this.sendEvent(t[e])}},i.prototype.sendEvent=function(t){var e=this.pulse.events.trackEngagement(1e3*t.totalActiveTime,t.scrollPosition);this.experiments&&(e.data.experiments=this.experiments),e.data["spt:pageViewId"]=t.pageViewId,e.data.object["@id"]=this.pulse.events.getUrnIdWithContentType(t.articleId,t.contentType),e.addCustomData("primary",{"spt:device":this.device,"spt:group":t.group,"spt:referrer":t.referrerInfo.referrer,"spt:isReferrerArticle":t.referrerInfo.isReferrerArticle,"spt:referrerId":t.referrerInfo.referrerId,"spt:previousReferrer":t.referrerInfo.previousReferrer,"spt:wordCount":t.wordCount,"spt:articleViewedPercentage":t.articleViewedPercentage,"spt:url":t.url,"spt:secondsSincePageView":parseInt((Date.now()-this.initialTimeInMs)/1e3,10),"spt:engageSdkVersion":p}),e.send()},i.prototype.destroy=function(){this.activityInterval&&window.clearInterval(this.activityInterval),this.pingInterval&&window.clearInterval(this.pingInterval);var t;for(t=0;t<this.windowEventTypes.length;t++)u.unbind(window,this.windowEventTypes[t],this.throttledUpdateActivity);for(t=0;t<this.bodyEventTypes.length;t++)u.unbind(document.body,this.bodyEventTypes[t],this.throttledUpdateActivity);
this.untrackScrollActivity(),this.reset()},i.prototype.setArticleId=function(t){this.articleId=t},i.prototype.setPageViewId=function(t){this.pageViewId=t},i.prototype.setGroup=function(t){this.group=t},i.prototype.setWordCount=function(t){this.wordCount=t},i.prototype.setUrl=function(t){this.url=t},i.prototype.setReferrerInfo=function(t){this.referrerInfo=t},i.prototype.setExperiments=function(t){this.experiments=t},i.prototype.setScrollContainer=function(t){this.untrackScrollActivity(),this.scrollContainer=t,this.trackScrollActivity()},i.prototype.setArticleContainer=function(t){this.articleContainer=t},i.prototype.reset=function(){l&&this.sendStoredEvents(),this.scrollPosition=0,this.totalActiveTime=0,this.lastActiveTime=0,this.lastPingSent=0},t.exports=i},function(t,e,r){function n(t,e,r){var n=!0,c=!0;if("function"!=typeof t)throw new TypeError(s);return r===!1?n=!1:o(r)&&(n="leading"in r?!!r.leading:n,c="trailing"in r?!!r.trailing:c),a.leading=n,a.maxWait=+e,a.trailing=c,i(t,e,a)}var i=r(58),o=r(18),s="Expected a function",a={leading:!1,maxWait:0,trailing:!1};t.exports=n},function(t,e,r){function n(t,e,r){function n(){m&&clearTimeout(m),h&&clearTimeout(h),h=m=y=void 0}function c(){var r=e-(o()-f);if(r<=0||r>e){h&&clearTimeout(h);var n=y;h=m=y=void 0,n&&(v=o(),d=t.apply(g,l),m||h||(l=g=null))}else m=setTimeout(c,r)}function u(){m&&clearTimeout(m),h=m=y=void 0,(b||w!==e)&&(v=o(),d=t.apply(g,l),m||h||(l=g=null))}function p(){if(l=arguments,f=o(),g=this,y=b&&(m||!I),w===!1)var r=I&&!m;else{h||I||(v=f);var n=w-(f-v),i=n<=0||n>w;i?(h&&(h=clearTimeout(h)),v=f,d=t.apply(g,l)):h||(h=setTimeout(u,n))}return i&&m?m=clearTimeout(m):m||e===w||(m=setTimeout(c,e)),r&&(i=!0,d=t.apply(g,l)),!i||m||h||(l=g=null),d}var l,h,d,f,g,m,y,v=0,w=!1,b=!0;if("function"!=typeof t)throw new TypeError(s);if(e=e<0?0:+e||0,r===!0){var I=!0;b=!1}else i(r)&&(I=r.leading,w="maxWait"in r&&a(+r.maxWait||0,e),b="trailing"in r?r.trailing:b);return p.cancel=n,p}var i=r(18),o=r(59),s="Expected a function",a=Math.max;t.exports=n},function(t,e,r){var n=r(13),i=n(i=Date.now)&&i,o=i||function(){return(new Date).getTime()};t.exports=o},function(t,e,r){function n(t,e){var r=a;if(arguments.length>2){var u=i(arguments,2),p=s(u,n.placeholder);r|=c}return o(t,r,e,u,p)}var i=r(61),o=r(62),s=r(73),a=1,c=32;n.placeholder={},t.exports=n},function(t,e){function r(t,e,r){var n=-1,i=t.length;e=null==e?0:+e||0,e<0&&(e=-e>i?0:i+e),r="undefined"==typeof r||r>i?i:+r||0,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=t[n+e];return o}t.exports=r},function(t,e,r){function n(t,e,r,n,y,v,w,b){var I=e&h;if(!I&&"function"!=typeof t)throw new TypeError(g);var x=n?n.length:0;if(x||(e&=~(d|f),n=y=null),x-=y?y.length:0,e&f){var T=n,j=y;n=y=null}var E=!I&&c(t),S=[t,e,r,n,y,T,j,v,w,b];if(E&&E!==!0&&(u(S,E),e=S[1],b=S[9]),S[9]=null==b?I?0:t.length:m(b-x,0)||0,e==l)var k=o(S[0],S[2]);else k=e!=d&&e!=(l|d)||S[4].length?s.apply(void 0,S):a.apply(void 0,S);var A=E?i:p;return A(k,S)}var i=r(63),o=r(65),s=r(68),a=r(74),c=r(75),u=r(77),p=r(78),l=1,h=2,d=32,f=64,g="Expected a function",m=Math.max;t.exports=n},function(t,e,r){var n=r(6),i=r(64),o=i?function(t,e){return i.set(t,e),t}:n;t.exports=o},function(t,e,r){(function(e){var n=r(13),i=n(i=e.WeakMap)&&i,o=i&&new i;t.exports=o}).call(e,function(){return this}())},function(t,e,r){function n(t,e){function r(){return(this instanceof r?n:t).apply(e,arguments)}var n=i(t);return r}var i=r(66);t.exports=n},function(t,e,r){function n(t){return function(){var e=i(t.prototype),r=t.apply(e,arguments);return o(r)?r:e}}var i=r(67),o=r(18);t.exports=n},function(t,e,r){(function(e){var n=r(18),i=function(){function t(){}return function(r){if(n(r)){t.prototype=r;var i=new t;t.prototype=null}return i||e.Object()}}();t.exports=i}).call(e,function(){return this}())},function(t,e,r){function n(t,e,r,w,b,I,x,T,j,E){function S(){for(var h=arguments.length,d=h,f=Array(h);d--;)f[d]=arguments[d];if(w&&(f=o(f,w,b)),I&&(f=s(f,I,x)),C||P){var y=S.placeholder,M=u(f,y);if(h-=M.length,h<E){var V=T?i(T):null,q=v(E-h,0),N=C?M:null,F=C?null:M,z=C?f:null,L=C?null:f;e|=C?g:m,e&=~(C?m:g),U||(e&=~(p|l));var W=n(t,e,r,z,N,L,F,V,j,q);return W.placeholder=y,W}}var H=A?r:this;return O&&(t=H[D]),T&&(f=c(f,T)),k&&j<f.length&&(f.length=j),(this instanceof S?R||a(t):t).apply(H,f)}var k=e&y,A=e&p,O=e&l,C=e&d,U=e&h,P=e&f,R=!O&&a(t),D=t;return S}var i=r(69),o=r(70),s=r(71),a=r(66),c=r(72),u=r(73),p=1,l=2,h=4,d=8,f=16,g=32,m=64,y=256,v=Math.max;t.exports=n},function(t,e){function r(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}t.exports=r},function(t,e){function r(t,e,r){for(var i=r.length,o=-1,s=n(t.length-i,0),a=-1,c=e.length,u=Array(s+c);++a<c;)u[a]=e[a];for(;++o<i;)u[r[o]]=t[o];for(;s--;)u[a++]=t[o++];return u}var n=Math.max;t.exports=r},function(t,e){function r(t,e,r){for(var i=-1,o=r.length,s=-1,a=n(t.length-o,0),c=-1,u=e.length,p=Array(a+u);++s<a;)p[s]=t[s];for(var l=s;++c<u;)p[l+c]=e[c];for(;++i<o;)p[l+r[i]]=t[s++];return p}var n=Math.max;t.exports=r},function(t,e,r){function n(t,e){for(var r=t.length,n=s(e.length,r),a=i(t);n--;){var c=e[n];t[n]=o(c,r)?a[c]:void 0}return t}var i=r(69),o=r(23),s=Math.min;t.exports=n},function(t,e){function r(t,e){for(var r=-1,i=t.length,o=-1,s=[];++r<i;)t[r]===e&&(t[r]=n,s[++o]=r);return s}var n="__lodash_placeholder__";t.exports=r},function(t,e,r){function n(t,e,r,n){function s(){for(var e=-1,i=arguments.length,o=-1,u=n.length,p=Array(i+u);++o<u;)p[o]=n[o];for(;i--;)p[o++]=arguments[++e];return(this instanceof s?c:t).apply(a?r:this,p)}var a=e&o,c=i(t);return s}var i=r(66),o=1;t.exports=n},function(t,e,r){var n=r(64),i=r(76),o=n?function(t){return n.get(t)}:i;t.exports=o},function(t,e){function r(){}t.exports=r},function(t,e,r){function n(t,e){var r=t[1],n=e[1],m=r|n,y=d|h,v=c|u,w=y|v|p|l,b=r&d&&!(n&d),I=r&h&&!(n&h),x=(I?t:e)[7],T=(b?t:e)[8],j=!(r>=h&&n>v||r>v&&n>=h),E=m>=y&&m<=w&&(r<h||(I||b)&&x.length<=T);if(!j&&!E)return t;n&c&&(t[2]=e[2],m|=r&c?0:p);var S=e[3];if(S){var k=t[3];t[3]=k?o(k,S,e[4]):i(S),t[4]=k?a(t[3],f):i(e[4])}return S=e[5],S&&(k=t[5],t[5]=k?s(k,S,e[6]):i(S),t[6]=k?a(t[5],f):i(e[6])),S=e[7],S&&(t[7]=i(S)),n&d&&(t[8]=null==t[8]?e[8]:g(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=m,t}var i=r(69),o=r(70),s=r(71),a=r(73),c=1,u=2,p=4,l=16,h=128,d=256,f="__lodash_placeholder__",g=Math.min;t.exports=n},function(t,e,r){var n=r(63),i=r(59),o=150,s=16,a=function(){var t=0,e=0;return function(r,a){var c=i(),u=s-(c-e);if(e=c,u>0){if(++t>=o)return r}else t=0;return n(r,a)}}();t.exports=a},function(t,e){"use strict";t.exports=function(t){var e=t.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,n=t.offsetHeight-e.bottom+r;return n<=0?0:Math.min(n,t.offsetHeight)}},function(t,e,r){"use strict";function n(t){i(this,t)}var i=r(8),o=r(54),s=r(81);n.prototype.setMetadata=function(t,e,r){if(!r.previewUrl||!r.previewUrl.http)throw new Error("previewUrl.http is required");if(!r.previewUrl||!r.previewUrl.https)throw new Error("previewUrl.https is required");i(this,e),this.previewUrl=r.previewUrl,this.pageId=r.pageId||o.normalizeUrl(e.permalink),t.setPage(this)},n.prototype.setPulseMetadata=function(t){return t.contentId=o.sdrn(this.site,"content",this.pageId),t.contentType="Frontpage",t.tags=this.tags,t.category=null,t},n.prototype.view=function(t,e,r){var n={"spt:site":this.site,"spt:url":e.getUrl(),"spt:pageId":this.pageId,"spt:device":this.device,"spt:permalink":this.permalink,"spt:shareUrl":this.shareUrl,"spt:previewUrl":this.previewUrl,"spt:imageUrl":this.imageUrl,"spt:referrer":e.getReferrer(),"spt:engageSdkVersion":r},i=t.events.trackContentView(this.title);this.experiments&&(i.data.experiments=this.experiments),i.addCustomData("primary",n).send()},n.prototype.createEngagementTime=function(){},n.prototype.updateEngagementTime=function(){},n.prototype.createImpressions=function(t){this.impressions||(this.impressions=new s(t,{site:this.site,device:this.device,pageId:this.pageId,experiments:this.experiments}),this.impressions.initialize())},n.prototype.destroy=function(){this.impressions&&(this.impressions.destroy(),this.impressions=null)},t.exports=n},function(t,e,r){"use strict";function n(t){for(var e=document.getElementsByTagName("*"),r=[],n=0;n<e.length;n++)e[n].hasAttribute(t)&&e[n].getAttribute(t)&&r.push(e[n]);return r}function i(){return{top:0,left:0,right:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,bottom:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0}}function o(t,e){return t.left>=e.left&&t.right<=e.right&&t.top>=e.top&&t.bottom<=e.bottom}function s(t,e,r){return t.left>=e.left&&t.right<=e.right&&(t.top>=e.top&&t.top<=e.bottom&&e.bottom-t.top>=r||t.bottom>=e.top&&t.bottom<=e.bottom&&t.bottom-e.top>=r||t.top<=e.top&&t.bottom>=e.bottom)}function a(t,e){this.throttledFindNewElementsInViewport=c(u(this.findNewElementsInViewport,f),this),this.elementsToSend=[],this.possibleElementsInViewport=n("data-engage-entity-id"),this.pulse=t,this.options=e}var c=r(60),u=r(57),p=r(45).getUuidV4,l=r(54),h="7.16.0",d=2e3,f=100;a.prototype.initialize=function(){this.sendInterval=window.setInterval(c(this.sendImpressionsIfExist,this),d),l.bind(window,"scroll",this.throttledFindNewElementsInViewport),l.bind(window,"resize",this.throttledFindNewElementsInViewport),this.throttledFindNewElementsInViewport(),this.sendImpressionsIfExist()},a.prototype.findNewElementsInViewport=function(){for(var t=i(),e=.33*(t.bottom-t.top),r=0;r<this.possibleElementsInViewport.length;r++){var n=this.possibleElementsInViewport[r];(o(n.getBoundingClientRect(),t)||s(n.getBoundingClientRect(),t,e))&&(n.hasAttribute("data-engage-already-sent")||(this.elementsToSend.push(n),n.setAttribute("data-engage-already-sent","true")))}},a.prototype.sendImpressionsIfExist=function(){0!==this.elementsToSend.length&&(this.sendImpressions(this.pulse,this.options,this.elementsToSend),this.elementsToSend=[])},a.prototype.sendImpressions=function(){for(var t=0;t<this.elementsToSend.length;t++){var e=this.elementsToSend[t],r=this.pulse.events.trackContentView();r.data["spt:pageViewId"]=p(),r.data.object.contentId=l.sdrn(this.options.site,"element",e.getAttribute("data-engage-entity-id")),r.data.object["@id"]=this.pulse.events.getUrnIdWithContentType(r.data.object.contentId,"Element"),r.data.object["@type"]="UIElement",r.addCustomData("primary",{"spt:device":this.options.device,"spt:engageSdkVersion":h,"spt:pageId":this.options.pageId,"spt:position":e.hasAttribute("data-engage-position")?parseInt(e.getAttribute("data-engage-position"),10):null,"spt:source":e.hasAttribute("data-engage-source")?e.getAttribute("data-engage-source"):null,"spt:transactionId":e.hasAttribute("data-engage-transaction-id")?e.getAttribute("data-engage-transaction-id"):null,"spt:isImpression":!0,"spt:pageViewId":this.pulse.pageViewId}),this.options.experiments&&(r.data.experiments=this.options.experiments),r.queue()}this.pulse.sendQueue()},a.prototype.destroy=function(){this.sendInterval&&window.clearInterval(this.sendInterval),l.unbind(window,"scroll",this.throttledFindNewElementsInViewport),l.unbind(window,"resize",this.throttledFindNewElementsInViewport);for(var t=0;t<this.possibleElementsInViewport.length;t++)this.possibleElementsInViewport[t].removeAttribute("data-engage-already-sent");this.possibleElementsInViewport=[],this.elementsToSend=[]},t.exports=a},function(t,e,r){"use strict";function n(t,e){this.referrer=t||document.referrer,this.url=e||window.location.href}function i(t,e){return c.urlExists(t)&&c.urlExists(e)&&c.getDomainFromUrl(t)===c.getDomainFromUrl(e)}function o(t,e){return t&&t.url&&t.url===e}function s(t,e,r){if(!a.enabled)return null;var n=null;if(i(e,r)){var s=a.get(t);o(s,e)&&(n=s)}return n}var a=r(37),c=r(54);n.prototype.evaluateReferringArticle=function(){return s("previousArticle",this.referrer,this.url)},n.prototype.evaluateReferringPage=function(){return s("previousPage",this.referrer,this.url)},n.prototype.evaluateReferringExperiment=function(){return s("referringExperiment",this.referrer,this.url)},n.prototype.evaluateReferringImpression=function(){return s("referringImpression",this.referrer,this.url)},n.prototype.setArticle=function(t){a.enabled&&(a.set("referringImpression",null),a.set("referringExperiment",null),a.set("previousPage",null),a.set("previousArticle",{url:this.url,referrer:this.referrer,articleId:t.articleId}))},n.prototype.setPage=function(t){a.enabled&&(a.set("referringImpression",null),a.set("referringExperiment",null),a.set("previousArticle",null),a.set("previousPage",{url:this.url,referrer:this.referrer,pageId:t.pageId,experiments:t.experiments||null}))},n.prototype.setReferringExperiment=function(t){a.enabled&&a.set("referringExperiment",{url:this.url,referrer:this.referrer,experiment:t})},n.prototype.setReferringImpression=function(t){a.enabled&&a.set("referringImpression",{url:this.url,referrer:this.referrer,impression:t})},n.prototype.setUrl=function(t){this.referrer=this.url,this.url=t},n.prototype.setReferrer=function(t){this.referrer=t||this.referrer},n.prototype.getUrl=function(){return this.url},n.prototype.getReferrer=function(){return this.referrer},t.exports=n}])});